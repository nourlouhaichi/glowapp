{% extends 'front/basefrontone.html.twig' %}






{% block title %}Programme index
{% endblock %}

{% block body %}

	<style>


		.icon-search-container i.fa-search {
			font-size: 20px;
			transition: transform 0.3s ease; /* Smooth transition for hover effect */
		}

		.icon-search-container:hover i.fa-search {
			transform: scale(1.1); /* Scale up the icon on hover */
		}


		/* Add more custom styles here */
	</style>


	<div class="container-fluid py-5 mt-5">
		<div class="container-fluid fruite py-5">
			<div class="container py-5">

				<div class="d-flex flex-row g-1">
					<h1 class="me-auto">Available Programs :</h1>
					<button type="submit" class="btn btn-primary border-2 border-secondary py-3 px-4  rounded-pill text-white h-100">
						<a href="{{ path('app_programme_new') }}" style="color: white"><i style="color: white" class="fa fa-plus me-2"></i> Create new</a>
					</button>
					<button style="margin-left: 10px" type="submit" class="btn btn-primary border-2 border-secondary py-3 px-4  rounded-pill text-white h-100">
						<a href="{{ path('app_objectif_new') }}" style="color: white"><i style="color: white" class="fa fa-bullseye me-2"></i> Add objective</a>
					</button>
				</div>


				<div class="row g-4">
					<div class="col-lg-12">

							<div style="margin: 10px; width: 100%">
								<div style="width: 100%; display: flex;" class="w-100 mx-auto">
									<input style="flex-grow: 1; height: 50px; border-top-left-radius: .375rem; border-bottom-left-radius: .375rem;" type="search" class="form-control" placeholder="keywords" aria-label="Search" aria-describedby="search-icon-1">
									<button id="search-icon-1" class="btn btn-primary border-2 border-secondary  btn-default" style="margin-left: -15px; border-radius: 30px; height: 50px; border-top-left-radius: .375rem; border-bottom-left-radius: .375rem;">
										 <span id="search-icon-1" class="icon-search-container">
                					<i class="fa fa-search" style="color: white;"></i>
           							 </span>
									</button>
								</div>
							</div>



						<div class="row g-4">
							<div class="col-lg-3">
								<div class="row g-4">


									<div class="row g-4">
										<div class="col-lg-12">
											<div class="mb-3">

												<h4>Categories</h4>
												<ul class="list-unstyled fruite-categorie">
													{% for category in categories %}
														<li>
															<div class="d-flex justify-content-between fruite-name">
																<a href="#" class="category-link" data-category-id="{{ category.id }}">
																	<i class="fas fa-folder me-2"></i>
																	{{ category.name }}
																</a>
																<span>({{ category.programs.count }})</span>
															</div>
														</li>
													{% endfor %}
												</ul>
											</div>
										</div>

									</div>
								</div>

							</div>

							<div class="col-lg-9">
								<div class="row g-4 justify-content-center">
									{% for programme in programmes %}
										<div class="col-md-6 col-lg-6 col-xl-4">
											<div  style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); padding: 10px" class="d-flex flex-column  rounded position-relative fruite-item gap-1">


												<div class="fruite-img">
													<img src="{{ asset('Uploads/Image/' ~ programme.image) }}" class="img-fluid w-100 rounded-top" style="min-height: 300px;max-height: 400px ;object-fit: cover;" alt="">
													<div class="text-white bg-secondary px-3 py-1 rounded position-absolute" style="top: 20px; left: 20px; ">Nutritionist/Coach</div>
												</div>


												<div class="d-flex flex-column">
													<div style="font-size: 16px; color: grey ; font-weight: bold">{{programme.titrePro}}</div>
													<p style="font-size: 12px">{{ programme.planPro }}</p>

													<div class="d-flex flex-column">
														<div class="d-flex justify-content-between  flex-lg-wrap gap-1">
															<p class=" fs-5 fw-bold mb-0">{{ programme.datePro ? programme.datePro|date('Y-m-d') : '' }}</p>
															<a href="{{ path('app_programme_show', {'id': programme.id}) }}" class="btn border border-secondary rounded-pill px-3 text-primary">
																<i class="fa fa-shopping-bag me-2 text-primary"></i>
																show details</a>
																
														</div>
													</div>
												</div>


											</div>
										</div>

									{% endfor %}


									<div class="col-12">
										<div class="pagination d-flex justify-content-center mt-5">

											{{ knp_pagination_render(programmes, 'pagination.html.twig') }}
										</div>
									</div>


								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
const categoryLinks = document.querySelectorAll('.fruite-categorie a');

categoryLinks.forEach(function (link) {
link.addEventListener('click', function (e) {
e.preventDefault();
const categoryId = this.dataset.categoryId;

fetch (`/programme/category/${categoryId}`, {
method: 'GET',
headers: {
'Accept': 'application/json',
'Content-Type': 'application/json',
'X-Requested-With': 'XMLHttpRequest'
}
}).then(response => {
if (!response.ok) {
throw new Error (`HTTP error! status: ${
response.status
}`);
}
return response.json();
}).then(programs => {
updateProgramsList(programs);
}).catch(error => {
console.error('Error:', error);
});
});
});

function updateProgramsList(programs) {
const programsContainer = document.querySelector('.row.g-4.justify-content-center');
programsContainer.innerHTML = ''; // Clear current programs

programs.forEach(program => {
const programElement = createProgramElement(program);
programsContainer.appendChild(programElement);
});
}


function createProgramElement(program) {
const div = document.createElement('div');
div.className = 'col-md-6 col-lg-6 col-xl-4';
div.innerHTML = `
            <div class="rounded position-relative fruite-item">
                <div class="fruite-img">
                    <img src="/Uploads/Image/${
program.image
}" class="img-fluid w-100 rounded-top" alt="">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute" style="top: 10px; left: 10px;">Nutritionist/Coach</div>
                <div class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h4>${
program.title
}</h4>
                    <p>${
program.plan
}</p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">${
program.date
}</p>
                        <a href="/programme/programme/${
program.id
}" class="btn border border-secondary rounded-pill px-3 text-primary">
                            <i class="fa fa-shopping-bag me-2 text-primary"></i>
                            show details</a>
                    </div>
                </div>
            </div>
        `;
return div;
}
});
	</script>





<script>
	document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('input[type="search"]');

    searchInput.addEventListener('keyup', function() {
        const keyword = this.value;

        fetch(`/programme/search/programmes?keyword=${keyword}`, {
            method: 'GET',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            }
        }).then(response => response.json())
        .then(data => updateProgramsList(data))
        .catch(error => console.error('Error:', error));
    });

    function updateProgramsList(programs) {
        const programsContainer = document.querySelector('.row.g-4.justify-content-center');
        programsContainer.innerHTML = '';
        programs.forEach(program => {
            const programElement = createProgramElement(program);
            programsContainer.appendChild(programElement);
        });
    }

    function createProgramElement(program) {
        const div = document.createElement('div');
        div.className = 'col-md-6 col-lg-6 col-xl-4';
        div.innerHTML = `
            <div class="rounded position-relative fruite-item">
                <div class="fruite-img">
                    <img src="/Uploads/Image/${program.image}" class="img-fluid w-100 rounded-top" alt="">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute" style="top: 10px; left: 10px;">Nutritionist/Coach</div>
                <div class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <h4>${program.titrePro}</h4>
                    <p>${program.planPro}</p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">${program.datePro ? new Date(program.datePro).toLocaleDateString() : ''}</p>
                        <a href="/programme/programme/${program.id}" class="btn border border-secondary rounded-pill px-3 text-primary">
                            <i class="fa fa-shopping-bag me-2 text-primary"></i>
                            show details</a>
                    </div>
                </div>
            </div>
        `;
        return div;
    }
});
</script>
{% endblock %}
